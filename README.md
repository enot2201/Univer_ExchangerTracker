# ExhangerRateTracker

docker-compose up
НО
Бывает и такое, и бывает часто, что сервисы не запускаются, тк. не успела подняться бд. И это с учетом настроенных кондиций. Так что иногда приходится поднимать в ручную(там 2 контейнера) первым запускается контейнер app


Для Кэширования использовался Redis
Брокер сообщений RabbitMQ

Реализовано два сервиса
1. Парсер
		Подключается к api, преобразует данные в единый формат, отправляет сообщения на брокер. 
		В этом сервисы реализованы интересные фичи, не оговоренные в тз. Наппример для добавления валютной пары нужно добавить(в случае binance) или изменить(в случае с coingeko) запись в таблице trade-info
		В этой же таблице указывается модуль, который должен обрабатывать указанное подключение. Для оговоренных случаев есть startup скрипт, который в случае отсутствии таблицы создаст ее и заполнит значениями
2. FastApi приложение
		На нем в фоне запущен consumer который подключается ко всем очередям(название очередей получаются путем не сложного лингвистического анализа данных из бд) и кэширует приходящие с них данные. Так же есть api метод, который возращает данные по валютным парам из кэша.
3. Телеграмм бот для отправления сообщений пользователю
		
Во всех сервисах реализовано логирование, но оп моему не всех уровней, но как будто там больше не воткнуть.
В целом что могу сказать:
	Архитектурно получился немного урод, но возможность масштабирования присутсвует(парсить новую площадку или валютную пару) иногда можно даже не изменяя код. Для тестового в полне сгодится как мне кажется.
	Нагрузочное тестирование я провел, но бомж в залез в трансформаторную будку и пролил коффе на трансформатор и мои скрины благополучно покинули сей бренный мир вместе с электричеством на 5 минут(в буфере были)
	Как появится возможность скину, ну или есть что-то типо такого:
		
	Type     Name                                                                          # reqs      # fails |    Avg     Min     Max    Med |   req/s  failures/s
--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------
GET      /api/v1/currency_pair/%7D?currency_pair=bitcoin-usd                            23722 13726(57.86%) |   4785      46   19366   2800 |  148.40      148.40
--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------
         Aggregated                                                                     23722 13726(57.86%) |   4785      46   19366   2800 |  148.40      148.40

Type     Name                                                                          # reqs      # fails |    Avg     Min     Max    Med |   req/s  failures/s
--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------
GET      /api/v1/currency_pair/%7D?currency_pair=bitcoin-usd                            24066 14070(58.46%) |   4891      46   19366   2800 |  126.50      126.50
--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------
         Aggregated                                                                     24066 14070(58.46%) |   4891      46   19366   2800 |  126.50      126.50

Type     Name                                                                          # reqs      # fails |    Avg     Min     Max    Med |   req/s  failures/s
--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------
GET      /api/v1/currency_pair/%7D?currency_pair=bitcoin-usd                            24228 14232(58.74%) |   4928      46   19814   2800 |   88.70       88.70

